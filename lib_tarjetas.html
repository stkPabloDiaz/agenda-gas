<script>
function crearTarjetaContactos() {
    limpiar();

    google.script.run
        .withSuccessHandler(crearTarjetasContactosOk)
        .withFailureHandler(crearTarjetasContactosError)
        .obtenerDatos();
}

function crearTarjetasContactosError() {
    // Mostrar Notificacion de Error
    crearNotificacionERROR('No se han podido Crear las Tarjetas de los contactos','Tarjetas de contactos');

    // Eliminar el Loader
    eliminarLoader();
}


function crearTarjetasContactosOk(datos) {
    // Extraer contactos
    let contactos = extraerContactos(datos);

    let tarjetas = document.createElement('div');
    tarjetas.id = 'tarjetasContactos';
    tarjetas.classList.add('container');

    // Por cada Contacto agregamos una Tarjeta
    contactos.forEach(contacto => tarjetas.appendChild(crearContactoTarjeta(contacto)));

    // Agregar Tarjetas
    document.getElementById('divContactos').appendChild(tarjetas);

    // Eliminar el Loader
    eliminarLoader();
}


function crearContactoTarjeta (contacto) {
    // divTarjeta
    let divTarjeta = document.createElement('div');
    divTarjeta.id = 'tarjeta'+contacto.indice;
    divTarjeta.classList.add('row', 'border', 'border-3', 'border-dark', 'rounded', 'bg-light', 'm-3', 'p-3');


    // Creamos datos y botones de la Tarjeta
    let datosTarjeta = crearDatosTarjeta(contacto);
    let divBotones = crearBotonesTarjeta(contacto);
    datosTarjeta.appendChild(divBotones);

    // Creamos Imagen de la Tarjeta
    let imagenTarjeta = crearImagenTarjeta(contacto);

    // Agregamos todo a divTarjeta y lo devolvemos
    divTarjeta.appendChild(datosTarjeta);
    divTarjeta.appendChild(imagenTarjeta);

    return divTarjeta;
}

function crearDatosTarjeta(contacto) {
    let datosTarjeta = document.createElement('div');
    datosTarjeta.classList.add('col-6', 'd-flex', 'flex-column', 'align-items-start');

    // Nombre y Apellido
    let nombre = document.createElement('h3');
    nombre.textContent = contacto.apellido + ', ' + contacto.nombre;

    // Correo
    let correo = document.createElement('div');
    correo.classList.add('d-flex');
    let iconoCorreo = document.createElement('i');
    iconoCorreo.classList.add('bi', 'bi-envelope-fill', 'me-2');
    let tituloCorreo = document.createElement('h5');
    tituloCorreo.textContent = contacto.correo;
    correo.appendChild(iconoCorreo);
    correo.appendChild(tituloCorreo);

    // Telefono
    let telefono = document.createElement('div');
    telefono.classList.add('d-flex');
    let iconoTelefono = document.createElement('i');
    iconoTelefono.classList.add('bi', 'bi-telephone-fill', 'me-2');
    let tituloTelefono = document.createElement('h5');
    tituloTelefono.textContent = contacto.telefono;
    telefono.appendChild(iconoTelefono);
    telefono.appendChild(tituloTelefono);

    // Agregamos datos
    datosTarjeta.appendChild(nombre);
    datosTarjeta.appendChild(correo);
    datosTarjeta.appendChild(telefono);

    return datosTarjeta;
}


function crearBotonesTarjeta(contacto) {
    let divBotones = document.createElement('div');
    divBotones.classList.add('d-flex', 'justify-content-start', 'mt-auto');

    divBotones.appendChild(crearBotonInfoContacto(contacto));
    divBotones.appendChild(crearBotonBorrarContacto(contacto));
    divBotones.appendChild(crearBotonModificarContacto(contacto));

    return divBotones;
}




function crearImagenTarjeta(contacto) {
    let imagenTarjeta = document.createElement('div');
    imagenTarjeta.classList.add('col-6', 'rounded', 'd-flex', 'justify-content-end');
    let cajaImagenTarjeta = document.createElement('div');
    cajaImagenTarjeta.classList.add('box', 'border', 'border-3', 'border-dark','rounded');
    let imagen = document.createElement('img');
    imagen.classList.add('img-fluid', 'rounded', 'img-contacto');
    imagen.src = contacto.imagen;

    // Agregamos imagen a la caja y tarjeta
    cajaImagenTarjeta.appendChild(imagen);
    imagenTarjeta.appendChild(cajaImagenTarjeta);

    return imagenTarjeta;
}


function mostrarInformacionAdicionalContacto(contacto) {

}

</script>