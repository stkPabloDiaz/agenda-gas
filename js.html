<script>
function crearTablaContactos() {
    google.script.run
    .withSuccessHandler(crearTablaContactosCorrectamente)
    .withFailureHandler(crearTablaContactosError)
    .obtenerContactos();
}



function crearTablaContactosCorrectamente(obj) {
    let tabla = document.getElementById('tablaContactos');
    if (tabla) tabla.remove();
    
    tabla = document.createElement('table');
    tabla.id = "tablaContactos";

    let tablaHeader = document.createElement('thead');
    let tablaBody = document.createElement('tbody');

    Array.from(obj).forEach((filaActual, i) => {
        let fila = document.createElement('tr');
        filaActual.forEach(celdaActual => {
            let celda = document.createElement('td');
            celda.textContent = celdaActual;
            fila.appendChild(celda);
        });
        if (i == 0) {
            tablaHeader.appendChild(fila);
            tabla.appendChild(tablaHeader);
        } else {
            tablaBody.appendChild(fila);
        }
    });

    // Agregamos el cuerpo a la Tabla
    tabla.appendChild(tablaBody);

    // Agregamos Clases a la Cabecera de la Tabla
    tablaHeader.classList.add('table-dark');
    
    // Agregamos Clases a la Tabla
    tabla.classList.add('table', 'table-striped', 'border', 'border-3');

    // Agregamos Tabla al la Pagina
    document.getElementById('divContactos').appendChild(tabla);

    // Mostrar Notificacion de OK
    crearNotificacion(1,'Contactos obtenidos correctamente','Todo en orden');

}

function crearTablaContactosError() {

    // Mostrar Notificacion de Error
}


function crearNotificacion(tipo, mensaje, titulo) {

    // Obtener datos
    let mensajeNotificacion = document.getElementById('mensajeNotificacion');
    let tituloNotificacion = document.getElementById('tituloNotificacion');
    let elementoNotificacion = document.getElementById('notificacion');
    let iconoNotificacion = document.getElementById('iconoNotificacion');
    let notificacion = bootstrap.Toast.getOrCreateInstance(elementoNotificacion);

    // Editar la Notificacion
    iconoNotificacion.className = '';
    iconoNotificacion.classList.add('bi', 'bi-check2-square');
    mensajeNotificacion.textContent = mensaje;
    tituloNotificacion.textContent = titulo;
    elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--color-verde-oscuro');

    // Mostrar Notificacion
    notificacion.show();

}




</script>