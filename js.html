<script>
    // Boton Subir
    window.addEventListener('scroll', function () {
        if (this.window.scrollY > 500) {
            document.getElementById('botonSubir').style.transform = "scale(1)";
        }
        if (this.window.scrollY < 500) {
            document.getElementById('botonSubir').style.transform = "scale(0)";
        }
    });

//      COMIENZO DE FUNCIONES
//      FUNCIONES VARIAS DE UTILIDADES
//

    // Ejecuta el Subir el Scroll desde el Boton
    function subirArriba() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }
//      
//      FUNCIONES VARIAS DE UTILIDADES
//      FINAL DE FUNCIONES




//      COMIENZO DE FUNCIONES
//      FUNCIONES RELACIONADAS CON CONTACTOS
//

    // INICIO:    MODIFICAR CONTACTO
    function modificarContacto(numFila) {
        limpiar();
        // Cerrar Modal
        bootstrap.Modal.getOrCreateInstance(document.getElementById('crearContactoModal')).hide();

        // Obtener nuevos datos a partir del Formulario
        let nombre = document.getElementById('nombre').value;
        let apellido = document.getElementById('apellido').value;
        let correo = document.getElementById('correo').value;
        let telefono = document.getElementById('telefono').value;


        google.script.run
            .withSuccessHandler(modificarContactoOk)
            .withFailureHandler(modificarContactoError)
            .modificarContacto(numFila, { nombre, apellido, correo, telefono });
    }

    function modificarContactoOk() {
        // Mostrar Notificacion
        crearNotificacionCONTACTO('Contacto Modificado correctamente', 'Modificar Contacto');
        mostrar();
    }

    function modificarContactoError() {
        // Mostrar Notificacion
        crearNotificacionERROR('El Contacto no se ha podido Modificar', 'Modificar Contacto');

        mostrar();
    }
    // FINAL:    MODIFICAR CONTACTO



    // INICIO:    BORRAR CONTACTO
    function borrarContacto(numFila) {
        limpiar();

        google.script.run
            .withSuccessHandler(borrarContactoOk)
            .withFailureHandler(borrarContactoError)
            .borrarContacto(numFila);
    }

    function borrarContactoOk() {
        // Mostrar Notificacion
        crearNotificacionBORRAR('Contacto Borrado correctamente', 'Borrar Contacto');

        mostrar();
    }

    function borrarContactoError() {
        // Mostrar Notificacion
        crearNotificacionERROR('El Contacto no se ha podido Borrar', 'Borrar Contacto');

        mostrar();

    }
    // FINAL:    BORRAR CONTACTO



    // INICIO:    INSERTAR CONTACTO
    function insertarContacto() {
        limpiar();

        // Obtener Datos
        let nombre = document.getElementById('nombre').value;
        let apellido = document.getElementById('apellido').value;
        let correo = document.getElementById('correo').value;
        let telefono = document.getElementById('telefono').value;

        // Cerrar Modal
        bootstrap.Modal.getInstance(document.getElementById('crearContactoModal')).hide();

        google.script.run
            .withSuccessHandler(crearContactoOk)
            .withFailureHandler(crearContactoError)
            .insertarContacto(nombre, apellido, correo, telefono);
    }

    // Si todo sale bien Borramos el contenido de los Inputs
    function crearContactoOk() {
        document.getElementById('nombre').value = '';
        document.getElementById('correo').value = '';

        // Mostrar notificacion
        crearNotificacionCONTACTO('Contacto insertado correctamente', 'Insertar Contacto');

        mostrar();
    }

    // Si Existen Errores
    function crearContactoError() {
        // Mostrar notificacion
        crearNotificacionERROR('No se ha podido insertar el contacto', 'Insertar Contacto');

        mostrar();
    }
    // FINAL:    INSERTAR CONTACTO


//      
//      FUNCIONES RELACIONADAS CON CONTACTOS
//      FINAL DE FUNCIONES





//      COMIENZO DE FUNCIONES
//      LIMPIAR TABLAS Y TARJETAS
//

    function mostrar() {
        crearTarjetaContactos();
        eliminarLoader();
    }


    function limpiar() {
        eliminarTabla();
        eliminarTarjetas();
        crearLoaderPuntos('divContactos');
    }

    // Borra la tabla de Contactos si ya existiera
    function eliminarTabla() {
        let tabla = document.getElementById('tablaContactos');
        if (tabla) tabla.remove();
    }

    // Borra Tarjetas de Contactos si ya existiera
    function eliminarTarjetas() {
        let tarjetas = document.getElementById('tarjetasContactos');
        if (tarjetas) tarjetas.remove();
    }


//      
//      LIMPIAR TABLAS Y TARJETAS
//      FINAL DE FUNCIONES



//      COMIENZO DE FUNCIONES
//      IMPORTAR CONTACTOS A TRAVES DE API DE TERCEROS
//
    function importarContacto() {
        limpiar();
        google.script.run
            .withSuccessHandler(importarContactosOk)
            .withFailureHandler(importarContactosError)
            .importarContactos();
    }

    function importarContactosOk() {
        crearNotificacionOK('Se han agregado los Contantos correctamente', 'Importar Contactos');
        mostrar();
    }

    function importarContactosError() {
        crearNotificacionERROR('No se han podido Importar los contactos', 'Importar Contactos');
        mostrar();
    }

//      
//      IMPORTAR CONTACTOS A TRAVES DE API DE TERCEROS
//      FINAL DE FUNCIONES


</script>